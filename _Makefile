SRC_DIR = ./src
OUT_DIR = ./out
OUT_NAME = game

CXX = gcc
CC_FLAGS = -g -Wall -O3 `sdl2-config --cflags`
LINK_FLAGS = `sdl2-config --libs`

SOURCES = $(wildcard $(SRC_DIR)/*.c)
OBJS = $(patsubst $(SRC_DIR)/%.c,$(OUT_DIR)/%.o,$(SOURCES))

all: main

main: $(OUT_DIR) $(OBJS)
	$(CXX) $(OBJS) $(LINK_FLAGS) -o $(OUT_NAME)

$(OUT_DIR)/%.o: $(SRC_DIR)/%.c
	$(CXX) $(CC_FLAGS) -o $@ -c $^

run: all
	./$(OUT_NAME)

clean:
	rm -f *.o game